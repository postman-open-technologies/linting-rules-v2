rules:
  http-get-recommended-200-response:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-get
    description: HTTP GET requests should supply a 200 OK response.
    severity: warn
    recommended: true
    message: "{{path}} does not supply a 200 OK response."
    formats:
    - oas2
    - oas3
    given: 
    - $.paths.*.get.responses
    then:
      field: "200"
      function: truthy
  http-authorized-methods:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-overview
    description: Any http methods specified should be one of the supported list.
    message: "{{property}} is not a supported method: {{error}}"
    given: 
      - $.paths.*.*~
      - $.paths.*.*.callbacks.*.*.*~
      - $.webhooks.*.*~
    severity: warn
    formats:
      - oas2
      - oas3
    then:
      function: pattern
      functionOptions:
        match: /^(options|get|head|post|put|delete|trace|connect|patch|parameters|x-.*)$/i
  http-get-recommended-200-response-dummy:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-get
    description: HTTP GET requests should supply a 200 OK response.
    severity: warn
    recommended: true
    message: "{{path}} does not supply a 200 OK response."
    formats:
    - oas2
    - oas3
    given: 
    - $.paths.*.get.responses
    then:
      field: "200"
      function: truthy
