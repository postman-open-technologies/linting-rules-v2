testSuiteVersion: spectral-v1.0
ruleset: http-authorized-methods.openapi-v2-v3.spectral-v6.yaml
rules:
  http-authorized-methods:  
    format: openapi
    versions:
      - "2.0"
      - "3.0"
      - "3.1"
    severity: error
    given:
      - description: must have a paths object
        expected:
          - path: "#/paths"
            value:
              /test:
                get: {}
                post: {}
                foo: {}
        documentTemplate:
          openapi: "3.1.0"
          paths:
            /test:
              get: {}
              post: {}
              foo: {}
    then:
      - description: must return a problem if one of the methods isn't supported
        expected:
          - path: "#/paths/foo"
        documentTemplate:
          openapi: "3.1.0"
          paths:
            /test:
              get: {}
              post: {}
              foo: {}
      - description: must return no problem if all paths are OK
        expected: []
        documentTemplate:
          openapi: "3.1.0"
          paths:
            /test:
              get: {}
              post: {}
