#--------------------------------------------------------------
# Spectral Rules for RFC9110 & RFC5789 (PATCH)
#--------------------------------------------------------------
documentationUrl: https://www.rfc-editor.org/rfc/rfc9110
rules:

  #--------------------------------------------------------------
  # 5.6.7.  Date/Time Formats
  #--------------------------------------------------------------

  # There are possibly some rules here that we might like to implement.


  #--------------------------------------------------------------
  # 6.6.1.  Date
  #--------------------------------------------------------------

  # The date field is likely to come from the server and most likely won't be called out in the API spec
  # is it necessary to specify a rule here?

  #--------------------------------------------------------------
  # 6.6.2.  Trailer
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 7.  Routing HTTP Messages
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 7.1.  Determining the Target Resource
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 7.2.  Host and :authority
  #--------------------------------------------------------------

  # The host field is likely to be generated by the client request library and most likely won't be called out in the API spec
  # is it necessary to specify a rule here?

  #--------------------------------------------------------------
  # 7.8.  Upgrade
  #--------------------------------------------------------------

  # We could have some rule that states if you have a HTTP 101 response code you must also specify an 'Upgrade' header field
  # Similarly with an HTTP 426 - the server must have an 'Upgrade' header.

  #--------------------------------------------------------------
  # 8.  Representation Data and Metadata
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.1.  Representation Data
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.2.  Representation Metadata
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.3.  Content-Type
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.3.1.  Media Type
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.3.2.  Charset
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.3.3.  Multipart Types
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.4.  Content-Encoding
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.4.1.  Content Codings
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.4.1.1.  Compress Coding
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.4.1.2.  Deflate Coding
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.4.1.3.  Gzip Coding
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.5.  Content-Language
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.5.1.  Language Tags
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.6.  Content-Length
  #--------------------------------------------------------------

  # We could validate here that the content-length response header is always an integer >= 0

  # Also: A server MUST NOT send a Content-Length header field in any response with a status code of 1xx (Informational) or 204 (No Content). 
  # A server MUST NOT send a Content-Length header field in any 2xx (Successful) response to a CONNECT request (Section 9.3.6).

  #--------------------------------------------------------------
  # 8.7.  Content-Location
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.8.  Validator Fields
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.8.1.  Weak versus Strong
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.8.2.  Last-Modified
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.8.2.1.  Generation
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.8.2.2.  Comparison
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.8.3.  ETag
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.8.3.1.  Generation
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.8.3.2.  Comparison
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 8.8.3.3.  Example: Entity Tags Varying on Content-Negotiated Resources
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 9.  Methods
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 9.1.  Overview
  #--------------------------------------------------------------

  http-authorized-methods:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-overview
    description: Any http methods specified should be one of the supported list.
    severity: warn
    recommended: true
    message: "{{property}} is not a supported method: {{error}}"
    formats:
    - oas3
    - oas2
    given: 
    - $.paths[*].*~
    - $.paths..callbacks[*][*].*~
    - $.webhooks[*].*~
    then:
      function: pattern
      functionOptions:
        match: /^(options|get|head|post|put|delete|trace|connect|patch)$/i

  #--------------------------------------------------------------
  # 9.3.  Method Definitions
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 9.3.1.  GET
  #--------------------------------------------------------------

  http-get-recommended-200-response:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-get
    description: HTTP GET requests should supply a 200 OK response.
    severity: warn
    recommended: true
    message: "{{path}} does not supply a 200 OK response."
    formats:
    - oas3
    - oas2
    given: 
    - $.paths.*.get.responses
    - $.paths[*][*].callbacks[*][*].get.responses
    - $.webhooks.*.get.responses
    then:
      field: "200"
      function: truthy

  http-get-oas3-no-request-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-get
    description: OAS3 HTTP GET requests should not specify any request body.
    severity: warn
    recommended: true
    message: "{{path}} should not specify a request body."
    formats:
    - oas3
    given: 
    - $.paths.*.get
    - $.callbacks.*.get
    - $.webhooks.*.get
    then:
      field: "requestBody"
      function: falsy

  http-get-oas2-no-request-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-get
    description: OAS2 HTTP GET requests should not specify any request body.
    severity: warn
    recommended: true
    message: "{{path}} should not specify a request body."
    formats:
    - oas2
    given: 
    - $.paths.*.get.parameters.*
    then:
      field: "in"
      function: pattern
      functionOptions:
        match: /[^(formData|body)]/i

  #--------------------------------------------------------------
  # 9.3.2.  HEAD
  #--------------------------------------------------------------

  http-head-recommended-200-response:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-head
    description: HTTP HEAD requests should supply a 200 OK response.
    severity: warn
    recommended: true
    message: "{{path}} does not supply a 200 OK response."
    formats:
    - oas3
    - oas2
    given: 
    - $.paths.*.head.responses
    - $.callbacks.*.head.responses
    - $.webhooks.*.head.responses
    then:
      field: "200"
      function: truthy

  http-head-no-response-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-head
    description: HTTP HEAD requests must not supply a response body.
    severity: error
    recommended: true
    message: "{{path}} must not send a response body."
    formats:
    - oas3
    - oas2
    given: 
    - $.paths.*.head.responses.*
    - $.callbacks.*.head.responses.*
    - $.webhooks.*.head.responses.*
    then:
      field: "content"
      function: falsy

  http-head-oas3-no-request-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-head
    description: HTTP HEAD requests should not specify a request body.
    severity: warn
    recommended: true
    message: "{{path}} should not specify a request body."
    formats:
    - oas3
    given: 
    - $.paths.*.head
    - $.callbacks.*.head
    - $.webhooks.*.head
    then:
      field: "requestBody"
      function: falsy

  http-head-oas2-no-request-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-head
    description: HTTP HEAD requests should not specify a request body.
    severity: warn
    recommended: true
    message: "{{path}} should not specify a request body."
    formats:
    - oas2
    given: 
    - $.paths.*.head.parameters.*
    then:
      field: "in"
      function: pattern
      functionOptions:
        match: /[^(formData|body)]/i

  #--------------------------------------------------------------
  # 9.3.3.  POST
  #--------------------------------------------------------------

  http-post-recommended-201-response:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-post
    description: HTTP POST requests should supply a 201 Created response.
    severity: warn
    recommended: true
    message: "{{path}} does not supply a 201 response."
    formats:
    - oas3
    - oas2
    given: 
    - $.paths.*.post.responses
    then:
      field: "201"
      function: truthy

  http-post-recommended-201-202-location-header:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-post
    description: HTTP POST requests should supply a location header on 201/202 responses.
    severity: info
    recommended: true
    message: "{{path}} should supply a location header on 201 or 202 responses."
    formats:
    - oas3
    - oas2
    given: 
    - $.paths.*.post.responses.[201,202]
    then:
      field: "headers.location"
      function: truthy

  http-post-optional-303-redirect:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-post
    description: HTTP POST requests may supply a 303 See Other response.
    severity: info
    message: "{{path}} may specify a 303 See Other response if the resource is already created."
    formats:
    - oas3
    - oas2
    given: 
    - $.paths.*.post.responses
    then:
      field: "303"
      function: truthy

  http-post-optional-303-redirect-location-header:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-post
    description: HTTP POST requests that supply a 303 See Other must supply a location header.
    severity: error
    message: "{{path}} must specify a location header."
    formats:
    - oas3
    - oas2
    given: 
    - $.paths.*.post.responses.[303]
    then:
      field: "headers.location"
      function: truthy

  http-post-not-allowable-response-status-codes:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-post
    description: HTTP POST requests must not supply 206, 304 or 416 status codes.
    severity: error
    recommended: true
    message: "{{path}} HTTP POST requests must not supply 206, 304 or 416 status codes."
    formats:
    - oas3
    - oas2
    given: 
    - $.paths.*.post.responses.[206,304,416]
    then:
      function: falsy

  http-post-oas2-request-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-post
    description: HTTP POST requests should specify a request body.
    severity: warn
    recommended: true
    message: "{{path}} should specify a request body."
    formats:
    - oas2
    given: 
    - $.paths.*.post.parameters.*
    then:
      field: "in"
      function: pattern
      functionOptions:
        match: /[(formData|body)]/i

  http-post-oas3-request-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-post
    description: HTTP POST requests should specify a request body.
    severity: warn
    recommended: true
    message: "{{path}} should specify a request body."
    formats:
    - oas3
    given: 
    - $.paths.*.post
    - $.callbacks.*.post
    - $.webhooks.*.post
    then:
      field: "requestBody"
      function: truthy

  #--------------------------------------------------------------
  # 9.3.4.  PUT
  #--------------------------------------------------------------
  
  http-put-recommended-status-codes:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-put
    description: HTTP PUT requests should supply a 200, 201 or 204 response codes.
    severity: warn
    recommended: true
    message: "{{path}} does not supply at least one of the required status codes."
    formats:
    - oas3
    - oas2
    given: 
    - $.paths.*.put.responses
    then:
      function: schema
      functionOptions:
        schema:
          $schema: "https://json-schema.org/draft/2020-12/schema"
          anyOf:
            - required:
                - '200'
              properties:
                '200': true
            - required:
                - '201'
              properties:
                '201': true
            - required:
                - '204'
              properties:
                '204': true

  http-put-recommended-201-202-location-header:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-put
    description: HTTP PUT requests should supply a location header on 201/202 responses.
    severity: info
    recommended: true
    message: "{{path}} should supply a location header on 201 or 202 responses."
    formats:
    - oas3
    - oas2
    given: 
    - $.paths.*.put.responses.[201,202]
    then:
      field: "headers.location"
      function: truthy

  http-put-oas2-request-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-put
    description: HTTP PUT requests should specify a request body.
    severity: warn
    recommended: true
    message: "{{path}} should specify a request body."
    formats:
    - oas2
    given: 
    - $.paths.*.put.parameters.*
    then:
      field: "in"
      function: pattern
      functionOptions:
        match: /[(formData|body)]/i

  http-put-oas3-request-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-put
    description: HTTP PUT requests should specify a request body.
    severity: warn
    recommended: true
    message: "{{path}} should specify a request body."
    formats:
    - oas3
    given: 
    - $.paths.*.put
    - $.callbacks.*.put
    - $.webhooks.*.put
    then:
      field: "requestBody"
      function: truthy


  #--------------------------------------------------------------
  # 9.3.5.  DELETE
  #--------------------------------------------------------------

  http-delete-recommended-status-codes:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-delete
    description: HTTP DELETE requests should supply a 200, 202 or 204 No Content response.
    severity: warn
    recommended: true
    message: "{{path}} does not supply one of the recommended status codes."
    formats:
    - oas3
    - oas2
    given: 
    - $.paths.*.delete.responses
    then:
      function: schema
      functionOptions:
        schema:
          $schema: "https://json-schema.org/draft/2020-12/schema"
          anyOf:
            - required:
                - '200'
              properties:
                '200': true
            - required:
                - '202'
              properties:
                '202': true
            - required:
                - '204'
              properties:
                '204': true
    

  http-delete-no-response-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-delete
    description: HTTP DELETE requests must not supply a response body.
    severity: error
    recommended: true
    message: "{{path}} must not send a response body."
    formats:
    - oas3
    - oas2
    given: 
    - $.paths.*.delete.responses.*
    - $.callbacks.*.delete.responses.*
    - $.webhooks.*.delete.responses.*
    then:
      field: "content"
      function: falsy

  http-delete-oas3-no-request-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-delete
    description: HTTP DELETE requests should not specify a request body.
    severity: warn
    recommended: true
    message: "{{path}} should not specify a request body."
    formats:
    - oas3
    given: 
    - $.paths.*.delete
    - $.callbacks.*.delete
    - $.webhooks.*.delete
    then:
      field: "requestBody"
      function: falsy

  http-delete-oas2-no-request-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-delete
    description: HTTP DELETE requests should not specify a request body.
    severity: warn
    recommended: true
    message: "{{path}} should not specify a request body."
    formats:
    - oas2
    given: 
    - $.paths.*.delete.parameters.*
    then:
      field: "in"
      function: pattern
      functionOptions:
        match: /[^(formData|body)]/i


  #--------------------------------------------------------------
  # 9.3.6.  CONNECT
  #--------------------------------------------------------------

  http-connect-recommended-400-bad-request-status-code:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-connect
    description: HTTP CONNECT requests should supply a 400 Bad Request response.
    severity: warn
    recommended: true
    message: "{{path}} does not supply a 400 status code."
    formats:
    - oas3
    - oas2
    given: 
    - $.paths.*.connect.responses
    then:
      field: "400"
      function: truthy

  http-connect-not-allowed-response-headers:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-connect
    description: HTTP CONNECT requests must not supply certain headers.
    severity: warn
    recommended: true
    message: "{{path}} must not supply transfer-encoding or content-length headers."
    formats:
    - oas3
    - oas2
    given: 
    - $.paths.*.connect.responses.*.headers
    then:
      - field: "content-length"
        function: falsy
      - field: "transfer-encoding"
        function: falsy

  http-connect-oas3-no-request-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-connect
    description: HTTP CONNECT requests should not specify a request body.
    severity: warn
    recommended: true
    message: "{{path}} should not specify a request body."
    formats:
    - oas3
    given: 
    - $.paths.*.connect
    - $.callbacks.*.connect
    - $.webhooks.*.connect
    then:
      field: "requestBody"
      function: falsy

  http-connect-oas2-no-request-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-connect
    description: HTTP CONNECT requests should not specify a request body.
    severity: warn
    recommended: true
    message: "{{path}} should not specify a request body."
    formats:
    - oas2
    given: 
    - $.paths.*.connect.parameters.*
    then:
      field: "in"
      function: pattern
      functionOptions:
        match: /[^(formData|body)]/i

  #--------------------------------------------------------------
  # 9.3.7.  OPTIONS
  #--------------------------------------------------------------


  # Should we put an OPTIONS with an allow response header here?


  #--------------------------------------------------------------
  # 9.3.8.  TRACE
  #--------------------------------------------------------------

  http-trace-recommended-200-ok-status-code:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-connect
    description: HTTP TRACE requests should supply a 200 OK response.
    severity: warn
    recommended: true
    message: "{{path}} does not supply a 200 OK status code."
    formats:
    - oas3
    - oas2
    given: 
    - $.paths.*.trace.responses
    then:
      field: "200"
      function: truthy
  
  http-trace-oas3-no-request-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-trace
    description: HTTP TRACE requests should not specify a request body.
    severity: error
    recommended: true
    message: "{{path}} should not specify a request body."
    formats:
    - oas3
    given: 
    - $.paths.*.trace
    - $.callbacks.*.trace
    - $.webhooks.*.trace
    then:
      field: "requestBody"
      function: falsy

  http-trace-oas2-no-request-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc9110#name-trace
    description: HTTP TRACE requests should not specify a request body.
    severity: error
    recommended: true
    message: "{{path}} should not specify a request body."
    formats:
    - oas2
    given: 
    - $.paths.*.trace.parameters.*
    then:
      field: "in"
      function: pattern
      functionOptions:
        match: /[^(formData|body)]/i

  #--------------------------------------------------------------
  # RFC5789 - PATCH
  #--------------------------------------------------------------

  http-patch-recommended-status-codes:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc5789
    description: HTTP PATCH requests should supply a 200, 201 or 204 response codes.
    severity: warn
    recommended: true
    message: "{{path}} does not supply at least one of the required status codes."
    formats:
    - oas3
    - oas2
    given: 
    - $.paths.*.patch.responses
    then:
      function: schema
      functionOptions:
        schema:
          $schema: "https://json-schema.org/draft/2020-12/schema"
          anyOf:
            - required:
                - '200'
              properties:
                '200': true
            - required:
                - '201'
              properties:
                '201': true
            - required:
                - '204'
              properties:
                '204': true

  http-patch-recommended-201-202-location-header:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc5789
    description: HTTP PATCH requests should supply a location header on 201/202 responses.
    severity: info
    recommended: true
    message: "{{path}} should supply a location header on 201 or 202 responses."
    formats:
    - oas3
    - oas2
    given: 
    - $.paths.*.patch.responses.[201,202]
    then:
      field: "headers.location"
      function: truthy

  http-patch-oas2-request-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc5789
    description: HTTP PATCH requests should specify a request body.
    severity: warn
    recommended: true
    message: "{{path}} should specify a request body."
    formats:
    - oas2
    given: 
    - $.paths.*.patch.parameters.*
    then:
      field: "in"
      function: pattern
      functionOptions:
        match: /[(formData|body)]/i

  http-patch-oas3-request-body:
    documentationUrl: https://www.rfc-editor.org/rfc/rfc5789
    description: HTTP PATCH requests should specify a request body.
    severity: warn
    recommended: true
    message: "{{path}} should specify a request body."
    formats:
    - oas3
    given: 
    - $.paths.*.patch
    - $.callbacks.*.patch
    - $.webhooks.*.patch
    then:
      field: "requestBody"
      function: truthy

  #--------------------------------------------------------------
  # 10. Message Context
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 10.1.  Request Context Fields
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 10.1.1.  Expect
  #--------------------------------------------------------------
  
  # Insert a rule here that validates the only allowed value of an 'Expect' request header is '100-continue'.
  # Also:
  # - Expect must only be used on requests that generate content 

  #--------------------------------------------------------------
  # 10.1.2.  From
  #--------------------------------------------------------------

  # Insert a rule that states the From header should conform to a valid email address.


  #--------------------------------------------------------------
  # 10.1.3.  Referer
  #--------------------------------------------------------------

  # MUST NOT include the fragment and userinfo components of the URI 
  # Must be either blank, contain a URL or the string 'about:blank'



  #--------------------------------------------------------------
  # 10.1.4.  TE
  #--------------------------------------------------------------

  # TODO

  #--------------------------------------------------------------
  # 10.1.5.  User-Agent
  #--------------------------------------------------------------

  # TODO


  #--------------------------------------------------------------
  # 10.2.  Response Context Fields
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 10.2.1.  Allow
  #--------------------------------------------------------------

  # 405 responses must specify an allow header with appropriate methods specified.

  #--------------------------------------------------------------
  # 10.2.2.  Location
  #--------------------------------------------------------------

  # 3xx responses should specify a location header
  # 2xx responses that should also have been catered for in the method level locations.
  # Responses must not contain both Content-Location and Location headers

  #--------------------------------------------------------------
  # 10.2.3.  Retry-After
  #--------------------------------------------------------------

  # Retry after can be sent with 503 or 3xx responses
  # Retry after must either be a non-negative integer, or an HTTP date (e.g. Fri, 31 Dec 1999 23:59:59 GMT)

  #--------------------------------------------------------------
  # 10.2.4.  Server
  #--------------------------------------------------------------

  # TODO


  #--------------------------------------------------------------
  # 11. HTTP Authentication
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 11.1.  Authentication Scheme
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 11.2.  Authentication Parameters
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 11.3.  Challenge and Response
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 11.4.  Credentials
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 11.5.  Establishing a Protection Space (Realm)
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 11.6.  Authenticating Users to Origin Servers
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 11.6.1.  WWW-Authenticate
  #--------------------------------------------------------------

  # A 401 response MUST specify a WWW-Authenticate response header containing at least one challenge.
  # 


  #--------------------------------------------------------------
  # 11.6.2.  Authorization
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 11.6.3.  Authentication-Info
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 11.7.  Authenticating Clients to Proxies
  #--------------------------------------------------------------

  # I think the proxy section should be moved to it's own ruleset.

  #--------------------------------------------------------------
  # 11.7.1.  Proxy-Authenticate
  #--------------------------------------------------------------

  # A proxy MUST send at least one Proxy-Authenticate header field in each 407 (Proxy Authentication Required) response that it generates.

  #--------------------------------------------------------------
  # 11.7.2.  Proxy-Authorization
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 11.7.3.  Proxy-Authentication-Info
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 12. Content Negotiation
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 12.1.  Proactive Negotiation
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 12.2.  Reactive Negotiation
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 12.3.  Request Content Negotiation
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 12.4.  Content Negotiation Field Features
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 12.4.1.  Absence
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 12.4.2.  Quality Values
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 12.4.3.  Wildcard Values
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 12.5.  Content Negotiation Fields
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 12.5.1.  Accept
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 12.5.2.  Accept-Charset
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 12.5.3.  Accept-Encoding
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 12.5.4.  Accept-Language
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 12.5.5.  Vary
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 13. Conditional Requests
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 13.1.  Preconditions
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 13.1.1.  If-Match
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 13.1.2.  If-None-Match
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 13.1.3.  If-Modified-Since
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 13.1.4.  If-Unmodified-Since
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 13.1.5.  If-Range
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 13.2.  Evaluation of Preconditions
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 13.2.1.  When to Evaluate
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 13.2.2.  Precedence of Preconditions
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 14. Range Requests
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 14.1.  Range Units
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 14.1.1.  Range Specifiers
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 14.1.2.  Byte Ranges
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 14.2.  Range
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 14.3.  Accept-Ranges
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 14.4.  Content-Range
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 14.5.  Partial PUT
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 14.6.  Media Type multipart/byteranges
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15. Status Codes
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.1.  Overview of Status Codes
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.2.  Informational 1xx
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.2.1.  100 Continue
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.2.2.  101 Switching Protocols
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.3.  Successful 2xx
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.3.1.  200 OK
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.3.2.  201 Created
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.3.3.  202 Accepted
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.3.4.  203 Non-Authoritative Information
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.3.5.  204 No Content
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.3.6.  205 Reset Content
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.3.7.  206 Partial Content
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.3.7.1.  Single Part
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.3.7.2.  Multiple Parts
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.3.7.3.  Combining Parts
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.4.  Redirection 3xx
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.4.1.  300 Multiple Choices
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.4.2.  301 Moved Permanently
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.4.3.  302 Found
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.4.4.  303 See Other
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.4.5.  304 Not Modified
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.4.6.  305 Use Proxy
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.4.7.  306 (Unused)
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.4.8.  307 Temporary Redirect
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.4.9.  308 Permanent Redirect
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.  Client Error 4xx
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.1.  400 Bad Request
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.2.  401 Unauthorized
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.3.  402 Payment Required
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.4.  403 Forbidden
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.5.  404 Not Found
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.6.  405 Method Not Allowed
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.7.  406 Not Acceptable
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.8.  407 Proxy Authentication Required
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.9.  408 Request Timeout
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.10. 409 Conflict
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.11. 410 Gone
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.12. 411 Length Required
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.13. 412 Precondition Failed
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.14. 413 Content Too Large
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.15. 414 URI Too Long
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.16. 415 Unsupported Media Type
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.17. 416 Range Not Satisfiable
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.18. 417 Expectation Failed
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.19. 418 (Unused)
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.20. 421 Misdirected Request
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.21. 422 Unprocessable Content
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.5.22. 426 Upgrade Required
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.6.  Server Error 5xx
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.6.1.  500 Internal Server Error
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.6.2.  501 Not Implemented
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.6.3.  502 Bad Gateway
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.6.4.  503 Service Unavailable
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.6.5.  504 Gateway Timeout
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 15.6.6.  505 HTTP Version Not Supported
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16. Extending HTTP
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.1.  Method Extensibility
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.1.1.  Method Registry
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.1.2.  Considerations for New Methods
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.2.  Status Code Extensibility
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.2.1.  Status Code Registry
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.2.2.  Considerations for New Status Codes
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.3.  Field Extensibility
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.3.1.  Field Name Registry
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.3.2.  Considerations for New Fields
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.3.2.1.  Considerations for New Field Names
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.3.2.2.  Considerations for New Field Values
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.4.  Authentication Scheme Extensibility
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.4.1.  Authentication Scheme Registry
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.4.2.  Considerations for New Authentication Schemes
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.5.  Range Unit Extensibility
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.5.1.  Range Unit Registry
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.5.2.  Considerations for New Range Units
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.6.  Content Coding Extensibility
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.6.1.  Content Coding Registry
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.6.2.  Considerations for New Content Codings
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 16.7.  Upgrade Token Registry
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17. Security Considerations
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.1.  Establishing Authority
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.2.  Risks of Intermediaries
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.3.  Attacks Based on File and Path Names
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.4.  Attacks Based on Command, Code, or Query Injection
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.5.  Attacks via Protocol Element Length
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.6.  Attacks Using Shared-Dictionary Compression
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.7.  Disclosure of Personal Information
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.8.  Privacy of Server Log Information
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.9.  Disclosure of Sensitive Information in URIs
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.10. Application Handling of Field Names
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.11. Disclosure of Fragment after Redirects
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.12. Disclosure of Product Information
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.13. Browser Fingerprinting
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.14. Validator Retention
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.15. Denial-of-Service Attacks Using Range
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.16. Authentication Considerations
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.16.1.  Confidentiality of Credentials
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.16.2.  Credentials and Idle Clients
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.16.3.  Protection Spaces
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 17.16.4.  Additional Response Fields
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 18. IANA Considerations
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 18.1.  URI Scheme Registration
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 18.2.  Method Registration
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 18.3.  Status Code Registration
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 18.4.  Field Name Registration
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 18.5.  Authentication Scheme Registration
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 18.6.  Content Coding Registration
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 18.7.  Range Unit Registration
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 18.8.  Media Type Registration
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 18.9.  Port Registration
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 18.10. Upgrade Token Registration
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 19. References
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 19.1.  Normative References
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # 19.2.  Informative References
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # Appendix A.  Collected ABNF
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # Appendix B.  Changes from Previous RFCs
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # B.1.  Changes from RFC 2818
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # B.2.  Changes from RFC 7230
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # B.3.  Changes from RFC 7231
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # B.4.  Changes from RFC 7232
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # B.5.  Changes from RFC 7233
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # B.6.  Changes from RFC 7235
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # B.7.  Changes from RFC 7538
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # B.8.  Changes from RFC 7615
  #--------------------------------------------------------------

  #--------------------------------------------------------------
  # B.9.  Changes from RFC 7694
  #--------------------------------------------------------------